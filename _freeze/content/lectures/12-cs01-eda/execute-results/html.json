{
  "hash": "73ae0a084c3019a287e17e50cf884989",
  "result": {
    "markdown": "---\ntitle: \"12-cs01-eda\"\nauthor: \"Professor Shannon Ellis\"\ndate: \"2023-11-07\"\n\nformat:\n  html: \n    output-file: 12-cs01-eda.html\n    embed-resources: true\n  revealjs:\n    output-file: 12-cs01-eda-slides.html\n    slide-number: true\n    chalkboard: false \n    preview-links: auto\n    logo: images/cogs137-logo-hex.png\n    css: slides.css\n    footer: <https://cogs137.github.io/website/>\n    scrollable: true\n    embed-resources: true\n    execute:\n      echo: true\n      eval: true\n---\n\n::: {.cell}\n\n:::\n\n\n# CS01: Biomarkers of Recent Use (EDA) {background-color=\"#92A86A\"}\n\n## Q&A {.smaller}\n\n> Q: was curious about the sensitivity/cut-offs/specificity, but we mainly discussed it in class already; was still slightly confused about it?\\\n> A: We'll discuss this in detail later this week and early next week!\n\n> Q: Are Youden's indices related to ROC curves?\\\n> A: Related, yes! We'll discuss both soon!\n\n> Q: I wasn‚Äôt sure how to interpret some of the visuals towards the end of lecture.\\\n> A: That's OK! We'll be recreating these and discussing them more as we do this case study in class.\n\n> Q: Did they actually use intravenous blood draws or just thumb pricks because multiple intravenous would not be fun. \\\n> A: It was venous blood from the arm. This unfunness is one of the reasons participants were compensated.\n\n> Q: Did this study (or other studies on THC) impairment end up influencing any legislation at the local or state level? \\\n> A: Great question! The state is currently reviewing these and other study's data. The state was definitely aware of this study and waited (im)patiently while we analyzed and worked to publish.\n\n> Q: How long should our reports be? \\\n> A: It's hard to say. We'll discuss an example today so you have a sense!\n\n> Q: Regarding the final project, will there be a Google form that we can fill out that will help us form groups if we can't form one ourselves?\\  \n> A: Yup - I'd say try to find a group using Piazza, in class, or during lab. However, if you're unable, when you fill out the form to indicate your group next week, you'll select that you'd like to be placed into a group.\n\n## Course Announcements\n\nDue Dates:\n\n- üî¨ Lab05 (MLR) due Friday\n- ‚ùì **Mid-course survey** \"due\" (for EC) Friday\n- üíª HW03 (MLR) due Mon 11/20\n\nNotes:\n\n- CS01 Groups have been sent out\n  - email for contact\n  - GitHub repo <- please accept and open; make sure you have access\n  - group mate feedback is required \n  - if you made changes to repo yesterday, be sure to pull to get data in your repo\n- Final Project: can use [Piazza](https://piazza.com/class/lmv46k9hwd66w7/post/5) to help find group mates\n\n. . . \n\n::: callout-important\nThe CS01 data are data for you only. My collaborator is excited that y'all will be working on this...but these are still research data, so please do not share with others or post publicly.\n:::\n\n## Agenda\n\n- Previous Projects\n- Exploring the Data\n\n# Previous Case Studies {background-color=\"#92A86A\"}\n\n## Example Case Study\n\nSee & Discuss: [https://cogs137.github.io/website/content/cs/cs-example.html]()\n\n## Feedback & Scores\n\nFeedback to other students [here](https://docs.google.com/spreadsheets/d/1GZINOZImtmkRDLGrWrBYVFxPxpK2GewC40_XMelLh1E/edit?usp=sharing)\n\n:::aside\nYou cannot see the projects, but can read all of the comments and see the associated score. Also, note that the same row is not the same group. \n:::\n\n. . . \n\nCommon comments:\n\n- context/explanation/guidance/lacking\n- missing citations\n- failure to introduce/describe the data\n- making statements without evidence\n- need to edit for cohesiveness, story, clarity\n\n## An (Example) Rubric\n\nThis is *NOT* the rubric for your case study, but it will be similar:\n\n![](images/12/rubric.png)\n\n## Notes\n\n::: incremental\n- Lots of code/plots will be provided here\n- You are free to include any of it in your own case study (no attribution needed)\n- You probably should NOT include all of them in your final report\n- For any of the \"basic\" plots you include in your report, you'll want to clean them up/improve their design.\n- Your final report should be polished from start to finish\n:::\n\n# Data & Files {background-color=\"#92A86A\"}\n\n## Packages\n\nTwo additional packages required for these notes:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(purrr)\nlibrary(rstatix)\n```\n:::\n\n\n\n## Our Datasets\n\nThree matrices:\n\n-   Blood (WB): 8 compounds; 190 participants\n-   Oral Fluid (OF): 7 compounds; 192 participants\n-   Breath (BR): 1 compound; 191 participants\n\n. . .\n\nVariables:\n\n-   `ID` \\| participants identifier\n-   `Treatment` \\| placebo, 5.90%, 13.40%\n-   `Group` \\| Occasional user, Frequent user\n-   `Timepoint` \\| indicator of which point in the timeline participant's collection occurred\n-   `time.from.start` \\| number of minutes from consumption\n-   & measurements for individual compounds\n\n## The Data\n\nReading in the .RData  we wrote at the end of the last set of notes...(using `load`)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"data/compounds.RData\")\nload(\"data/timepoints.RData\")\nload(\"data/data_clean.RData\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nThis reads the objects stored in these files into your Environment for use.\n\n\n## What to do with all of these functions?\n\nFor example...we discussed this function in the last set of notes. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n drop_dups <- function(dataset){\n  out <- dataset |> \n    filter(!is.na(timepoint_use)) |> \n    group_by(timepoint_use) |> \n    distinct(id, .keep_all=TRUE) |> \n    ungroup()\n  return(out)\n } \n```\n:::\n\n\n. . .\n\nWe're going to have a lot of functions throughout...like this helper function to clean up names\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# helper function to clean up name of two compounds\nclean_gluc <- function(df){\n  df <- df %>% \n    mutate(compound=gsub('GLUC', 'gluc',gsub(\"_\",\"-\",toupper(compound))),\n           compound=gsub('THCOH', '11-OH-THC', compound))\n  return(df)\n}\n```\n:::\n\n\n. . .\n\nFunctions can/should be stored in a separate `.R` file, probably in a `src/` directory.\n\n. . . \n\nTo have access to the functions in that file...\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(\"path/to/file\")\n```\n:::\n\n\n. . . \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(\"src/cs01_functions.R\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n# EDA {background-color=\"#92A86A\"}\n\n## Single Variable (basic) plots\n\nFor a single compound...\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(WB, aes(x=thc)) + geom_histogram()\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-9-1.png){width=2100}\n:::\n:::\n\n\n. . . \n\nBut, with wide data, that's not easy to do for all compounds, so you may want to pivot those data....\n\n\n::: {.cell}\n\n```{.r .cell-code}\nWB_long <- WB |> \n  pivot_longer(6:13) |>\n  rename(\"fluid\" = \"fluid_type\")\n```\n:::\n\n\n. . .\n\nDistribtions across all compounds (WB):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(WB_long, aes(x=value)) + \n  geom_histogram() +\n  facet_wrap(~name)\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-11-1.png){width=2100}\n:::\n:::\n\n. . .\n\nNow the same for OF and BR:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nOF_long <- OF |> pivot_longer(6:12)\nBR_long <- BR |> pivot_longer(6)\n```\n:::\n\n\n. . .\n\nCombining long datasets:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_full <- bind_rows(WB_long, OF_long, BR_long)\n```\n:::\n\n\n. . .\n\nPlotting some of these data...\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_full |>\n  mutate(group_compound = paste0(fluid,\": \", name)) |>\nggplot(aes(x=value)) + \n  geom_histogram() + \n  facet_wrap(~group_compound, scales=\"free\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-14-1.png){width=2100}\n:::\n:::\n\n\n## Two variables at a time\n\n## THC & Frequency\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_full |> \n  filter(name==\"thc\") |>\n  ggplot(aes(x=group, y=value)) + \n  geom_boxplot() +\n  facet_wrap(~fluid, scales=\"free\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-15-1.png){width=2100}\n:::\n:::\n\n\n\n## THC & Treatment Group\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_full |> \n  filter(name==\"thc\") |>\n  ggplot(aes(x=treatment, y=value)) + \n  geom_boxplot() +\n  facet_wrap(~fluid, scales=\"free\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-16-1.png){width=2100}\n:::\n:::\n\n\n## Focus on a specific timepoint...\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_full |> \n  filter(name==\"thc\", timepoint==\"T2A\") |>\n  ggplot(aes(x=treatment, y=value)) + \n  geom_boxplot() +\n  facet_wrap(~fluid, scales=\"free\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-17-1.png){width=2100}\n:::\n:::\n\n\n## At this point...\n\nWe start to get a sense of the data with these quick and dirty plots, but we're really only scratching the surface of what's going on in these data.\n\n. . .\n\nThese data require a lot of exploration due to the number of compounds, multiple matrices, and data over time aspects.\n\n## Compounds across time \n\n::: panel-tabset\n\n### Code\n\n::: {.cell}\n\n```{.r .cell-code}\ncompound_scatterplot_group <- function(dataset, compound, timepoints){\n  if(max(dataset[,compound],na.rm=TRUE)==0){\n    print(\n      dataset %>% \n        filter(!is.na(time_from_start)) %>%\n        ggplot(aes_string(x=\"time_from_start\", \n                          y=compound,\n                          color=\"group\")) + \n        geom_point() +\n        geom_vline(data=timepoints, aes(xintercept=as.numeric(stop)), \n                   linetype=\"dashed\", \n                   color=\"gray28\") +\n        scale_color_manual(values=c(\"#19831C\", \"#A27FC9\")) +\n        scale_y_continuous(limits=c(0,3)) +\n        theme_classic() +\n        theme(legend.position=\"bottom\",\n              legend.title=element_blank()) +\n        labs(x='Time From Start (min)',\n             y=gsub('GLUC', 'gluc',gsub(\"_\", \"-\", toupper(compound))))\n    )}else{\n      print(\n        dataset %>% \n          filter(!is.na(time_from_start)) %>%\n          ggplot(aes_string(x=\"time_from_start\", \n                            y=compound,\n                            color=\"group\")) + \n          geom_point() +\n          geom_vline(data=timepoints, aes(xintercept=as.numeric(stop)), \n                     linetype=\"dashed\", \n                     color=\"gray28\")  +\n          scale_color_manual(values=c(\"#19831C\", \"#A27FC9\")) +\n          theme_classic() +\n          theme(legend.position=\"bottom\",\n                legend.title=element_blank()) +\n          labs(x='Time From Start (min)',\n               y=gsub('GLUC', 'gluc', gsub(\"_\", \"-\", toupper(compound))))\n      )\n    }\n}\n```\n:::\n\n\n### Execute (WB)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscatter_wb <- map(compounds_WB, ~ compound_scatterplot_group( \n    dataset=WB_dups, \n    compound=.x, \n    timepoints=timepoints_WB))\n```\n:::\n\n\n\n### Plots (WB)\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-19-1.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-19-2.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-19-3.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-19-4.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-19-5.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-19-6.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-19-7.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-19-8.png){width=2100}\n:::\n:::\n\n\n\n\n### OF\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscatter_of <- map(compounds_OF, ~ compound_scatterplot_group( \n    dataset=OF_dups, \n    compound=.x, \n    timepoints=timepoints_OF))\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/compounds-of-1.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/compounds-of-2.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/compounds-of-3.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/compounds-of-4.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/compounds-of-5.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/compounds-of-6.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/compounds-of-7.png){width=2100}\n:::\n:::\n\n\n### BR\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscatter_br <- map(compounds_BR, ~ compound_scatterplot_group( \n    dataset=BR_dups, \n    compound=.x, \n    timepoints=timepoints_BR))\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/compounds-br-1.png){width=2100}\n:::\n:::\n\n\n:::\n\n## Pairplots\n\n:::panel-tabset\n\n### WB\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(WB[,unlist(compounds_WB)], \n      pch=19, \n      cex=0.3, \n      cex.labels=0.6,\n      labels=gsub('GLUC','gluc',gsub(\"_\",\"-\",toupper(colnames(WB[,unlist(compounds_WB)])))))\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-20-1.png){width=2100}\n:::\n:::\n\n\n### OF\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(OF[,unlist(compounds_OF)], \n      pch=19, \n      cex=0.4, \n      cex.labels=0.6,\n      labels=gsub('GLUC','gluc',gsub(\"_\",\"-\",toupper(colnames(OF[,unlist(compounds_OF)])))))\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-21-1.png){width=2100}\n:::\n:::\n\n\n### BR\n\n[‚ùì Why is there no pairplot for Breath?]{style=\"background-color: #ADD8E6\"}\n\n:::\n\n## Group Differences: Frequency of Use\n\n:::panel-tabset\n\n### Code\n\n::: {.cell}\n\n```{.r .cell-code}\ncompound_boxplot_group_only <- function(dataset, compounds, tissue, legend=TRUE, y_lab=TRUE){\n  timepoint_to_use = levels(dataset$timepoint_use)[1]\n  df <- dataset %>% \n    filter(timepoint_use == timepoint_to_use) %>%\n    select(group, all_of(compounds)) \n  df <- df %>% \n    gather(compound, value, -group) %>% \n    clean_gluc() %>% \n    group_by(compound) %>% \n    mutate(y_max = 1.2*max(value)) %>% \n    group_by(compound, group) %>% \n    mutate(n = n(),\n           my_label = paste0(group, ' N=', n),\n           my_label =  gsub(\" \", \"\\n\", my_label))\n  \n  if(tissue == \"Blood\"){\n    df$compound = factor(df$compound, levels=c(\"THC\",\"11-OH-THC\",\"THCCOOH\",\"THCCOOH-gluc\")) \n  }\n  \n  y_pos <- df %>% \n    group_by(compound) %>% \n    summarize(y.position = mean(y_max))\n  \n  stat.test <- df %>%\n    group_by(compound) %>%\n    t_test(value ~ my_label) %>%\n    adjust_pvalue(method = \"bonferroni\") %>%\n    add_significance()\n  test <- stat.test %>%\n    left_join(y_pos) %>%\n    mutate(p.adj.signif = ifelse(p.adj.signif=='?', 'ns', p.adj.signif),\n           p.adj = ifelse(p.adj < 0.001, \"<0.001\", p.adj))\n\n  if(legend){\n    leg_position = 'right'\n  }else{\n    leg_position = 'none'\n  }\n  \n  if(y_lab){\n    y_text = \"Concentration (ng/mL)\"\n  }else{\n    y_text = ''\n  }\n  \n  medianFunction <- function(x){\n    return(data.frame(y=round(median(x),1),label=round(median(x,na.rm=T),1)))}\n  \n  \n  p2 <- ggplot(df, aes(x=my_label, y=value, fill=my_label)) + \n    geom_jitter(position=position_jitter(width=.3, height=0), size = 0.8, color=\"gray65\")  +\n    geom_boxplot(outlier.shape=NA, alpha=0.6) +\n    stat_summary(fun = \"median\", geom = \"point\", shape = 19, size = 3, fill = \"black\") + \n    stat_summary(fun.data = medianFunction, geom =\"text\", color = \"black\", size = 3.5, vjust = -0.65) +\n    facet_wrap(~compound, scales=\"free_y\", ncol=4) +\n    geom_blank(aes(y = y_max)) + \n    scale_y_continuous(limits = c(0, NA), expand = expansion(mult = c(0, 0.1))) +\n    # scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +\n    scale_fill_manual(values=c(\"#19831C\", \"#A27FC9\")) +\n    theme_classic() +\n    theme(text = element_text(size=14),\n          legend.position=leg_position,\n          legend.title=element_blank(),\n          panel.grid = element_blank(),\n          strip.background = element_blank()) +\n    labs(title = tissue,\n         x = '',\n         y = y_text) \n  \n  ann_text <- test %>% \n    select(compound, p.adj, value = y.position, my_label=group1) %>%\n    filter(p.adj < 0.05) %>% \n    mutate(x1 = 1, x2 = 2)\n  \n  if(tissue == \"Whole Blood\"){\n    ann_text$compound = factor(ann_text$compound, \n                               levels=c(\"THC\",\"11-OH-THC\",\"THCCOOH\",\"THCCOOH-gluc\")) \n  }\n  \n  \n  p2 + geom_text(data = ann_text, label = ann_text$p.adj, nudge_x = 0.5) +\n    geom_segment(data = ann_text, aes(x = x1, xend = x2, \n                                      y = value - (0.04 * value), yend = value - (0.04*value)))\n  \n}\n```\n:::\n\n\n### WB\n\n::: {.cell}\n\n```{.r .cell-code}\ncompound_boxplot_group_only(WB_dups, compounds=unlist(compounds_WB), tissue=\"Whole Blood\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-23-1.png){width=2100}\n:::\n:::\n\n\n### OF\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompound_boxplot_group_only(OF_dups, compounds=unlist(compounds_OF), tissue=\"Oral Fluid\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-24-1.png){width=2100}\n:::\n:::\n\n\n### BR\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompound_boxplot_group_only(BR_dups, compounds=unlist(compounds_BR), tissue=\"Breath\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-25-1.png){width=2100}\n:::\n:::\n\n:::\n\n## Group Differences: Treatment \n\n:::panel-tabset\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompound_boxplot_treatment <- function(dataset, compounds, tissue){\n  timepoint_to_use=levels(dataset$timepoint_use)[2]\n  df <- dataset %>% \n    filter(timepoint_use == timepoint_to_use) %>%\n    select(treatment, group, compounds)\n  df <- df %>% \n    gather(compound, value, -treatment, -group) %>% \n    clean_gluc()\n  \n  df %>% \n    ggplot(aes(x=treatment, y=value, fill=group)) + \n    # geom_jitter(color=\"gray36\") +\n    geom_boxplot(outlier.size=0.1) +\n    scale_fill_manual(values=c(\"#19831C\", \"#A27FC9\")) +\n    facet_wrap(~compound, scales=\"free_y\", ncol=4) +\n    scale_x_discrete(labels=function(x) str_wrap(x, width=11)) +\n    theme_classic(base_size=10) +\n    theme(legend.position=\"bottom\",\n          legend.title=element_blank(),\n          panel.grid=element_blank(),\n          strip.background=element_blank()) +\n    labs(title=tissue,\n         x=\"Treatment\",\n         y=\"Measurement (ng/mL)\")\n  \n}\n```\n:::\n\n\n\n### WB\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompound_boxplot_treatment(WB_dups, compounds=unlist(compounds_WB), tissue=\"Whole Blood\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/all-the-plots-treatment-1.png){width=100%}\n:::\n:::\n\n\n### OF\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompound_boxplot_treatment(OF_dups, compounds=unlist(compounds_OF), tissue=\"Oral Fluid\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-27-1.png){width=100%}\n:::\n:::\n\n\n### BR\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncompound_boxplot_treatment(BR_dups, compounds=unlist(compounds_BR), tissue=\"Breath\")\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-28-1.png){width=2100}\n:::\n:::\n\n\n:::\n\n## Compound Summaries\n\n:::panel-tabset\n\n### Code\n\n\n::: {.cell}\n\n```{.r .cell-code}\nT2A_plot <- function(dataset, compound, timepoint_use=2){\n  timepoint_to_use=levels(factor(dataset$timepoint_use))[timepoint_use]\n  if(max(dataset[,compound],na.rm=TRUE)==0){\n    print(\n      ggplot(subset(dataset, timepoint_use==timepoint_to_use), \n             aes_string(x=\"group\", \n                        y=compound, \n                        fill=\"group\")) + \n        geom_boxplot(outlier.size=0.1) +\n        scale_fill_manual(values=c(\"#19831C\", \"#A27FC9\")) +\n        scale_x_discrete(labels=function(x) str_wrap(x, width=10)) +\n        scale_y_continuous(limits=c(0,3)) +\n        facet_grid(~treatment) + \n        theme_classic() +\n        theme(legend.position=\"none\",\n              panel.grid=element_blank(),\n              strip.background=element_blank(),\n              plot.title.position=\"plot\") +\n        labs(title=paste0('Timepoint: ', \n                            levels(dataset$timepoint_use)[timepoint_use],\n                            ' post-smoking'),\n             x='Group',\n             y=gsub('GLUC', 'gluc',gsub(\"_\", \"-\", toupper(compound))))\n    )}else{\n      print(\n        \n        ggplot(subset(dataset, timepoint_use==timepoint_to_use), \n               aes_string(x=\"group\", \n                          y=compound, \n                          fill=\"group\")) + \n          geom_boxplot(outlier.shape=NA, alpha=0.8) +\n          scale_fill_manual(values=c(\"#19831C\", \"#A27FC9\")) +\n          scale_x_discrete(labels=function(x) str_wrap(x, width=10)) +\n          facet_grid(~treatment) + \n          theme_classic() +\n          theme(legend.position=\"none\",\n                panel.grid=element_blank(),\n                strip.background=element_blank(),\n              plot.title.position=\"plot\") +\n          labs(title=paste0('Timepoint: ', \n                              levels(dataset$timepoint_use)[timepoint_use],\n                              ' post-smoking'),\n               x='Group',\n               y=gsub('GLUC', 'gluc',gsub(\"_\",\"-\",toupper(compound))))\n      )\n    }\n}\n```\n:::\n\n\n### WB\n\n\n::: {.cell}\n\n```{.r .cell-code}\npost_wb <- map(compounds_WB, ~ T2A_plot( \n    dataset=WB_dups, \n    compound=.x))\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-30-1.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-30-2.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-30-3.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-30-4.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-30-5.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-30-6.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-30-7.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-30-8.png){width=2100}\n:::\n:::\n\n\n### OF\n\n::: {.cell}\n\n```{.r .cell-code}\npost_of <- map(compounds_OF, ~ T2A_plot( \n    dataset=OF_dups, \n    compound=.x))\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-31-1.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-31-2.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-31-3.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-31-4.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-31-5.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-31-6.png){width=2100}\n:::\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-31-7.png){width=2100}\n:::\n:::\n\n\n### BR\n\n\n::: {.cell}\n\n```{.r .cell-code}\npost_br <- map(compounds_BR, ~ T2A_plot( \n    dataset=BR_dups, \n    compound=.x))\n```\n\n::: {.cell-output-display}\n![](12-cs01-eda_files/figure-html/unnamed-chunk-32-1.png){width=2100}\n:::\n:::\n\n:::\n\n\n## Recap {.smaller background-color=\"#92A86A\"}\n\n- Can you explain/describe the plots generated in the context of these data?\n- Can you generate EDA plots of your own for these data\n- Can you undersetand/work through the more complicated code provided (even if you couldn't have come up with it on your own)\n\n",
    "supporting": [
      "12-cs01-eda_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}