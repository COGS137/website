---
title: "16-cs02-eda"
author: "Professor Shannon Ellis"
date: "2023-03-07"

format:
  html: 
    output-file: 16-cs02-eda.html
    embed-resources: true
  revealjs:
    output-file: 16-cs02-eda-slides.html
    slide-number: true
    chalkboard: false 
    preview-links: auto
    logo: images/cogs137-logo-hex.png
    css: slides.css
    footer: <https://cogs137.github.io/website/>
    scrollable: true
    embed-resources: true
    execute:
      echo: true
      eval: true
---

# CS02: Vaping Behaviors in American Youth (EDA) {background-color="#92A86A"}



## Course Announcements {.smaller}

**Due Dates**:

- Lecture Participation survey "due" after class
- Lab08 Due Friday (CS02 EDA)
- CS02 due Monday of Finals week (3/20)
- Final Project due Th of Finals week (3/23)

. . .

**Notes**:

- cs01 group work form is still open - please complete (if you haven't)
- cs02 and final project groups/repos assigned
- don't wait until finals week to do cs02 and final project



```{r packages, echo = FALSE, message=FALSE, warning=FALSE}
library(tidyverse)

# ggplot2 color palette with gray
color_palette <- list(gray = "#999999", 
                      salmon = "#E69F00", 
                      lightblue = "#56B4E9", 
                      green = "#009E73", 
                      yellow = "#F0E442", 
                      darkblue = "#0072B2", 
                      red = "#D55E00", 
                      purple = "#CC79A7")

knitr::opts_chunk$set(fig.height = 3.5, dpi = 300, echo=TRUE, warning=FALSE, message=FALSE) 
```


# Questions {background-color="#92A86A"}

1. How has tobacco and e-cigarette/vaping use by American youths changed since 2015?
2. How does e-cigarette use compare between males and females?
3. What vaping brands and flavors appear to be used the most frequently?
4. Is there a relationship between e-cigarette/vaping use and other tobacco use?


## Data

...will only work if you finished last set of notes (or open this week's lab).

```{r}
load("data/wrangled/wrangled_data_vaping.rda")
```

## Question

When is pivoting your data from wide to long (or long to wide) helpful?

. . . 

```{r, eval=FALSE}
data |>
   pivot_longer(cols = columns_to_pivot , names_to = "new_col_for_labels" , values_to = "new_col_for_values")
```


## EDA: Brainstorm

**What do you want to know?**

Notes from class:

- count:
  - by age groups - age distribution
  - Grade
  - `Group`
  - Sex: Males, Females, NA
- Relative proportion of e-cig use by gender (anecdote: spent cartridges in male br and not female in hs; hypothesis: male use higher than females, but want to see)
- Distribution of most popular brands (all brands)
- Distribution of most popuular flavors (all flavors)
- year on the x-axis; y is frequency of use; some measurement of use (e-cig, tobacco, ...)

## EDA: `skim`

```{r}
library(skimr)
skim(nyts_data)
```

**Note**: If you include this in a report, you should also guide the viewer. Theres *a lot* in there. What do you want your reader to know?

Things discussed in class when looking at `skim` output:

- why `brand_ecig` has so many missing values (only have brand information for 2019)
- what `mean` calculation for a categorical value means (proportion of `TRUE` values)
- why `Age` min and max values look *off* (b/c it's coded as a character due to `>18` category)
- that the `n` category is how many respondents there are each year

Remember: It can be very helpful to thinkg "what overall trends do I see?" *and* "is there anything weird going on?" any time you're looking at an EDA output

## EDA: Basics

Getting a sense for some of the categorical data

```{r}
table(nyts_data$Age)
```

```{r}
table(nyts_data$Group)
```

```{r}
table(nyts_data$year)
```

Remember: If you include this in a report, you'll also need text to explain what the reader should know/take away from any of these.

## EDA: Plots 

## Sex by Year

```{r}
nyts_data |>
  group_by(year) |>
  count(Sex) |> 
  ggplot(aes(x=year, y=n, color=Sex)) + 
  geom_col()
```

(Note: I argued that this was *not* the best way to display these data...but it's a good start. If you include in your report, you likely want to improve!)

## E-Cig use by gender

Student suggestion: Relative proportion of e-cig use by gender (anecdote: spent cartridges in male br and not female in hs; hypothesis: male use higher than females, but want to see)

```{r}

```

## Brands

Student suggestion: Distribution of most popular brands (all brands)

```{r}
nyts_data |> 
  group_by(year) |>
  count(brand_ecig)
```

The above helps us remember that we only have brand information from 2019.

. . . 

```{r, eval=TRUE}
nyts_data |> 
  filter(year == 2019, !is.na(brand_ecig)) |> 
  ggplot(aes(x=brand_ecig)) +
  geom_bar()
```

Note: If including in a report, you'll want titles, cleaner axis names, and likely to sort the x-axis values, but for your first pass EDA where you're just trying to understand the data, this is sufficient.

## Flavors

Student suggestion: Distribution of most popular flavors (all flavors)

This one is more complicated b/c flavor data are across multiple columns...going to leave this for the analysis set of notes

## Tabacco use across time

Student suggestion: year on the x-axis; y is frequency of use; some measurement of use (e-cig, tobacco, ...)

```{r}

```


## Suggested Reading

-   [Case Study from OCS](https://www.opencasestudies.org/ocs-bp-vaping-case-study/)
