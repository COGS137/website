<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.146">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Professor Shannon Ellis">
<meta name="dcterms.date" content="2023-01-17">

<title>COGS 137 - 02-dplyr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/cogs137-logo-hex.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">COGS 137</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../schedule.html" rel="" target="">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../policies.html" rel="" target="">
 <span class="menu-text">Policies</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/COGS137" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://datahub.ucsd.edu/" rel="" target=""><i class="bi bi-cloud-fill" role="img" aria-label="Datahub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">02-dplyr</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Lecture Slides</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/00-welcome-slides.html" class="sidebar-item-text sidebar-link">00-welcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/01-intro-to-r-slides.html" class="sidebar-item-text sidebar-link">01-intro-to-r</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/02-dplyr-slides.html" class="sidebar-item-text sidebar-link">02-dplyr</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/03-tidyr-slides.html" class="sidebar-item-text sidebar-link">03-tidyr</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/04-ggplot2-slides.html" class="sidebar-item-text sidebar-link">04-ggplot2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/05-viz-slides.html" class="sidebar-item-text sidebar-link">05-viz</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/06-analysis-slides.html" class="sidebar-item-text sidebar-link">06-analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/07-linear-models-slides.html" class="sidebar-item-text sidebar-link">07-linear-models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/08-effective-communication-slides.html" class="sidebar-item-text sidebar-link">08-effective-communication</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/09-projects-slides.html" class="sidebar-item-text sidebar-link">09-projects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/10-mlr-slides.html" class="sidebar-item-text sidebar-link">10-mlr</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/11-cs01-data-slides.html" class="sidebar-item-text sidebar-link">11-cs01-data</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lecture Notes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/00-welcome.html" class="sidebar-item-text sidebar-link">00-welcome</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/01-intro-to-r.html" class="sidebar-item-text sidebar-link">01-intro-to-r</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/02-dplyr.html" class="sidebar-item-text sidebar-link active">02-dplyr</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/03-tidyr.html" class="sidebar-item-text sidebar-link">03-tidyr</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/04-ggplot2.html" class="sidebar-item-text sidebar-link">04-ggplot2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/05-viz.html" class="sidebar-item-text sidebar-link">05-viz</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/06-analysis.html" class="sidebar-item-text sidebar-link">06-analysis</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/07-linear-models.html" class="sidebar-item-text sidebar-link">07-linear-models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/08-effective-communication.html" class="sidebar-item-text sidebar-link">08-effective-communication</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/09-projects.html" class="sidebar-item-text sidebar-link">09-projects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/10-mlr.html" class="sidebar-item-text sidebar-link">10-mlr</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/11-cs01-data.html" class="sidebar-item-text sidebar-link">11-cs01-data</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Labs</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/01-lab-intro-r.html" class="sidebar-item-text sidebar-link">Lab01: Tooling and R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/02-lab-wrangling.html" class="sidebar-item-text sidebar-link">Lab02: Wrangling</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/03-lab-viz.html" class="sidebar-item-text sidebar-link">Lab03: Data Viz</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/04-lab-modelling.html" class="sidebar-item-text sidebar-link">Lab04: Modelling</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/05-lab-mlr.html" class="sidebar-item-text sidebar-link">Lab05: MLR</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Lab Slides</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labslides/01-lab-deck.html" class="sidebar-item-text sidebar-link">Lab01</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labslides/02-lab-deck.html" class="sidebar-item-text sidebar-link">Lab02</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labslides/03-lab-deck.html" class="sidebar-item-text sidebar-link">Lab03</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Lab Answers</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lab-ans/lab02-wrangling-ans.html" class="sidebar-item-text sidebar-link">Lab02: Wrangling (Ans)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lab-ans/lab03-viz-ans.html" class="sidebar-item-text sidebar-link">Lab03: Data Viz (Ans)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lab-ans/lab04-modelling-ans.html" class="sidebar-item-text sidebar-link">Lab04: Modelling (Ans)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">Homework</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/hw/hw-01.html" class="sidebar-item-text sidebar-link">HW01</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/hw/hw-02.html" class="sidebar-item-text sidebar-link">HW02</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/hw/hw-03.html" class="sidebar-item-text sidebar-link">HW03</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">Exam</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/exams/practice-exam.html" class="sidebar-item-text sidebar-link">Practice Midterm</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/exams/practice-exam-ans.html" class="sidebar-item-text sidebar-link">Practice Midterm (Ans)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/exams/midterm_wi23.html" class="sidebar-item-text sidebar-link">Midterm</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">Case Studies</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/cs/cs01.html" class="sidebar-item-text sidebar-link">CS01</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-maniuplation-with-dplyr" id="toc-data-maniuplation-with-dplyr" class="nav-link active" data-scroll-target="#data-maniuplation-with-dplyr">Data Maniuplation with <code>dplyr</code></a>
  <ul class="collapse">
  <li><a href="#qa" id="toc-qa" class="nav-link" data-scroll-target="#qa">Q&amp;A</a></li>
  <li><a href="#course-announcements" id="toc-course-announcements" class="nav-link" data-scroll-target="#course-announcements">Course Announcements</a></li>
  <li><a href="#agenda" id="toc-agenda" class="nav-link" data-scroll-target="#agenda">Agenda</a></li>
  <li><a href="#philosophy" id="toc-philosophy" class="nav-link" data-scroll-target="#philosophy">Philosophy</a></li>
  </ul></li>
  <li><a href="#pipes" id="toc-pipes" class="nav-link" data-scroll-target="#pipes">Pipes</a>
  <ul class="collapse">
  <li><a href="#the-pipe-in-baser" id="toc-the-pipe-in-baser" class="nav-link" data-scroll-target="#the-pipe-in-baser">The pipe in baseR</a></li>
  <li><a href="#where-does-the-name-come-from" id="toc-where-does-the-name-come-from" class="nav-link" data-scroll-target="#where-does-the-name-come-from">Where does the name come from?</a></li>
  <li><a href="#review-how-does-a-pipe-work" id="toc-review-how-does-a-pipe-work" class="nav-link" data-scroll-target="#review-how-does-a-pipe-work">Review: How does a pipe work?</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#nc-dot-fatal-crashes-in-north-carolina" id="toc-nc-dot-fatal-crashes-in-north-carolina" class="nav-link" data-scroll-target="#nc-dot-fatal-crashes-in-north-carolina">NC DOT Fatal Crashes in North Carolina</a></li>
  <li><a href="#variables" id="toc-variables" class="nav-link" data-scroll-target="#variables">Variables</a></li>
  <li><a href="#viewing-your-data" id="toc-viewing-your-data" class="nav-link" data-scroll-target="#viewing-your-data">Viewing your data</a></li>
  </ul></li>
  <li><a href="#dplyr" id="toc-dplyr" class="nav-link" data-scroll-target="#dplyr"><code>dplyr</code></a>
  <ul class="collapse">
  <li><a href="#a-grammar-of-data-manipulation" id="toc-a-grammar-of-data-manipulation" class="nav-link" data-scroll-target="#a-grammar-of-data-manipulation">A Grammar of Data Manipulation</a></li>
  <li><a href="#dplyr-rules-for-functions" id="toc-dplyr-rules-for-functions" class="nav-link" data-scroll-target="#dplyr-rules-for-functions"><strong><code>dplyr</code></strong> rules for functions</a></li>
  <li><a href="#filter-rows-with-filter" id="toc-filter-rows-with-filter" class="nav-link" data-scroll-target="#filter-rows-with-filter">Filter rows with <code>filter</code></a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><code>filter</code></a></li>
  <li><a href="#filter-1" id="toc-filter-1" class="nav-link" data-scroll-target="#filter-1"><code>filter</code></a></li>
  <li><a href="#aside-real-data-is-messy" id="toc-aside-real-data-is-messy" class="nav-link" data-scroll-target="#aside-real-data-is-messy">Aside: real data is messy!</a></li>
  <li><a href="#careful-data-scientists-clean-up-their-data-first" id="toc-careful-data-scientists-clean-up-their-data-first" class="nav-link" data-scroll-target="#careful-data-scientists-clean-up-their-data-first">Careful data scientists clean up their data first!</a></li>
  <li><a href="#correct-and-overwrite-mutate" id="toc-correct-and-overwrite-mutate" class="nav-link" data-scroll-target="#correct-and-overwrite-mutate">Correct and overwrite <code>mutate</code></a></li>
  <li><a href="#check-before-you-move-on" id="toc-check-before-you-move-on" class="nav-link" data-scroll-target="#check-before-you-move-on">Check before you move on</a></li>
  <li><a href="#mutate-to-add-new-variables" id="toc-mutate-to-add-new-variables" class="nav-link" data-scroll-target="#mutate-to-add-new-variables"><code>mutate</code> to add new variables</a></li>
  <li><a href="#save-when-you-mutate" id="toc-save-when-you-mutate" class="nav-link" data-scroll-target="#save-when-you-mutate">“Save” when you <code>mutate</code></a></li>
  <li><a href="#transmute-to-create-a-new-dataset" id="toc-transmute-to-create-a-new-dataset" class="nav-link" data-scroll-target="#transmute-to-create-a-new-dataset"><code>transmute</code> to create a new dataset</a></li>
  <li><a href="#mutate-vs.-transmute" id="toc-mutate-vs.-transmute" class="nav-link" data-scroll-target="#mutate-vs.-transmute"><code>mutate</code> vs.&nbsp;<code>transmute</code></a></li>
  <li><a href="#your-turn" id="toc-your-turn" class="nav-link" data-scroll-target="#your-turn">Your Turn</a></li>
  <li><a href="#slice-for-certain-row-numbers" id="toc-slice-for-certain-row-numbers" class="nav-link" data-scroll-target="#slice-for-certain-row-numbers"><code>slice</code> for certain row numbers</a></li>
  <li><a href="#slice-for-certain-row-numbers-1" id="toc-slice-for-certain-row-numbers-1" class="nav-link" data-scroll-target="#slice-for-certain-row-numbers-1"><code>slice</code> for certain row numbers</a></li>
  <li><a href="#select-to-keep-only-the-variables-you-mention" id="toc-select-to-keep-only-the-variables-you-mention" class="nav-link" data-scroll-target="#select-to-keep-only-the-variables-you-mention"><code>select</code> to keep only the variables you mention</a></li>
  <li><a href="#or-select-to-exclude-variables" id="toc-or-select-to-exclude-variables" class="nav-link" data-scroll-target="#or-select-to-exclude-variables">or <code>select</code> to exclude variables</a></li>
  <li><a href="#or-select-a-range-of-variables" id="toc-or-select-a-range-of-variables" class="nav-link" data-scroll-target="#or-select-a-range-of-variables">or <code>select</code> a range of variables</a></li>
  <li><a href="#pull-to-extract-a-column-as-a-vector" id="toc-pull-to-extract-a-column-as-a-vector" class="nav-link" data-scroll-target="#pull-to-extract-a-column-as-a-vector"><code>pull</code> to extract a column as a vector</a></li>
  <li><a href="#the-two-pulls-in-your-lives" id="toc-the-two-pulls-in-your-lives" class="nav-link" data-scroll-target="#the-two-pulls-in-your-lives">The two <code>pull</code>s in your lives</a></li>
  <li><a href="#rename-specific-columns" id="toc-rename-specific-columns" class="nav-link" data-scroll-target="#rename-specific-columns"><code>rename</code> specific columns</a></li>
  <li><a href="#rename-specific-columns-1" id="toc-rename-specific-columns-1" class="nav-link" data-scroll-target="#rename-specific-columns-1"><code>rename</code> specific columns</a></li>
  <li><a href="#check-before-you-move-on-1" id="toc-check-before-you-move-on-1" class="nav-link" data-scroll-target="#check-before-you-move-on-1">Check before you move on</a></li>
  <li><a href="#your-turn-1" id="toc-your-turn-1" class="nav-link" data-scroll-target="#your-turn-1">Your Turn</a></li>
  <li><a href="#summarize-to-reduce-variables-to-values" id="toc-summarize-to-reduce-variables-to-values" class="nav-link" data-scroll-target="#summarize-to-reduce-variables-to-values"><code>summarize</code> to reduce variables to values</a></li>
  <li><a href="#and-arrange-to-order-rows" id="toc-and-arrange-to-order-rows" class="nav-link" data-scroll-target="#and-arrange-to-order-rows">and <code>arrange</code> to order rows</a></li>
  <li><a href="#count-to-group-by-then-count" id="toc-count-to-group-by-then-count" class="nav-link" data-scroll-target="#count-to-group-by-then-count"><code>count</code> to group by then count</a></li>
  <li><a href="#select-rows-with-sample_n-or-sample_frac" id="toc-select-rows-with-sample_n-or-sample_frac" class="nav-link" data-scroll-target="#select-rows-with-sample_n-or-sample_frac">Select rows with <code>sample_n</code> or <code>sample_frac</code></a></li>
  <li><a href="#distinct-to-filter-for-unique-rows" id="toc-distinct-to-filter-for-unique-rows" class="nav-link" data-scroll-target="#distinct-to-filter-for-unique-rows"><code>distinct</code> to filter for unique rows</a></li>
  <li><a href="#distinct-has-a-.keep_all-parameter" id="toc-distinct-has-a-.keep_all-parameter" class="nav-link" data-scroll-target="#distinct-has-a-.keep_all-parameter"><code>distinct</code> has a .keep_all parameter</a></li>
  </ul></li>
  <li><a href="#factors" id="toc-factors" class="nav-link" data-scroll-target="#factors">Factors</a>
  <ul class="collapse">
  <li><a href="#factors-1" id="toc-factors-1" class="nav-link" data-scroll-target="#factors-1">Factors</a></li>
  <li><a href="#returning-to-cat-lovers" id="toc-returning-to-cat-lovers" class="nav-link" data-scroll-target="#returning-to-cat-lovers">Returning to: Cat lovers</a></li>
  <li><a href="#read-data-in-as-character-strings" id="toc-read-data-in-as-character-strings" class="nav-link" data-scroll-target="#read-data-in-as-character-strings">Read data in as character strings</a></li>
  <li><a href="#but-coerce-when-plotting" id="toc-but-coerce-when-plotting" class="nav-link" data-scroll-target="#but-coerce-when-plotting">But coerce when plotting</a></li>
  <li><a href="#use-forcats-to-manipulate-factors" id="toc-use-forcats-to-manipulate-factors" class="nav-link" data-scroll-target="#use-forcats-to-manipulate-factors">Use <code>forcats</code> to manipulate factors</a></li>
  <li><a href="#forcats-functionality" id="toc-forcats-functionality" class="nav-link" data-scroll-target="#forcats-functionality"><code>forcats</code> functionality <img src="images/01/hex-forcats.png" width="10%" align="left"></a></li>
  </ul></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a>
  <ul class="collapse">
  <li><a href="#suggested-reading" id="toc-suggested-reading" class="nav-link" data-scroll-target="#suggested-reading">Suggested Reading</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="/Users/shannonellis/Desktop/Teaching/COGS137/website/content/lectures/02-dplyr-slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">02-dplyr</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Professor Shannon Ellis </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 17, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="data-maniuplation-with-dplyr" class="level1 page-columns page-full" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Data Maniuplation with <code>dplyr</code></h1>
<div class="cell">
<div class="cell-output-display">

</div>
</div>
<section id="qa" class="level2 scrollable smaller">
<h2 class="scrollable smaller anchored" data-anchor-id="qa">Q&amp;A</h2>
<blockquote class="blockquote">
<p>Q: what does <code>|&gt;</code> mean?<br>
A: It means “and then” and is called a “pipe.” Discussing this in more detail in today’s lecture!</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: I think the lab is much more harder than the lecture.<br>
A: This first week there is a lot to learn regarding tooling, but once you’ve got that down the “process” of completing a lab will become second nature. Then, it’s just content…and applying something is always more difficult than listening to it being explained. So, labs will be a bit harder than lecture…but that’s by design b/c 1) we grade on effort (it’s ok to be wrong in labs!) and 2) answer keys will be posted (learning from mistakes/places we struggle is a great way to learn!)</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: Just curious about the oral presentation portion of the final project. Will this be a requirement in the form of a recorded video (like in COGS 108), or will we be presenting our project findings live in front of the class on the due date?<br>
A: There are going to be two options (most likely). A recording will <em>definitely</em> be an option. We’re also hoping to have an option where you can come present live, to the instructional staff and any students who want to learn from one another.</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: I am curious about the similarities and differences between both of Python and R!<br>
A: Very briefly, some similarities: both are object-oriented programming languages (although R is not <em>only</em> object-oriented); both are great for data analysis; differences: python arguably has a simpler syntax; R is, at its core, designed for statistical analysis so I’d argue it’s better for that; Python is a general-programming language so it’s arguablly better for software development; R has an implementation of the grammar of graphics, so I’d argue it’s better for data visualization (but some would disagree).</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: How can I understand dataframes in R easier?<br>
A: With practice! Today’s lecture, this week 2 lab, and your first hw will help you get additional practice. Then, we’ll use them throughout the course and build your understanding.</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: For very large data sets, how would you be able to find every type coercion?<br>
A: Each column would have a single type. <code>glimpse()</code> would help you identify the type of each column. From there, you can edit any that are not what you wanted.</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: Where would be a good location to get some practice on most of the packages we will be using in this class?<br>
A: The labs and homeworks are one place. But, there are also exercises in the “textbook” for this class: https://r4ds.had.co.nz/</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: How do we grasp Markdown easier?<br>
A: Trying things out and learning the basic rules. I would recommend starting with an RMarkdown document and just typing a sentence. Then knit to see what that looks like. Then, try to bold and italicize some text. Then try to add some headers. Then, add a bulleted list. Each time knitting to see the output. With that, you’ll have most of the markdown you’ll need! <a href="https://www.markdownguide.org/cheat-sheet/">reference for basics</a></p>
</blockquote>
<blockquote class="blockquote">
<p>Q: I am still not sure whether this class focuses more on the programming aspect or the mathematical concepts<br>
A: Both! First 5 weeks, more programming; Last 5: combination of both are used, but new programming concepts aren’t introduced a ton, so we focus on the stats while continuing to use what we learned the first five weeks!</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: Is there any rules for coercion?<br>
A: There are rules! Summarized <a href="https://www.oreilly.com/library/view/r-in-a/9781449358204/ch05s08.html">here</a></p>
</blockquote>
<blockquote class="blockquote">
<p>Q: When do we use R markdown?<br>
A: When completing labs, homework assignments, case studies, and likely on the final project. You can also take notes in RMarkdown, but that’s up to you!</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: Never heard about <code>ggplot2</code>. I think everyone had already heard of it previously…<br>
A: While some students have, you’re not alone! We’ll have two lectures on this and get plenty of practice soon!</p>
</blockquote>
</section>
<section id="course-announcements" class="level2">
<h2 class="anchored" data-anchor-id="course-announcements">Course Announcements</h2>
<p><strong>Due Dates</strong>:</p>
<ul>
<li><strong>Lab 02</strong> due Friday (1/20; 11:59 PM)</li>
<li><strong>HW01</strong> due Monday (1/23; 11:59 PM)</li>
<li>Lecture Participation survey “due” after class</li>
</ul>
<p><strong>Notes</strong> (1/19):</p>
<ul>
<li>Lab01 Graded - see GitHub issue for comments; 2pts == full credit
<ul>
<li>Common issues:
<ul>
<li>Did not knit file to HTML</li>
<li>Did not include name in file</li>
<li>You do not need to version control the .RProj file</li>
<li>You should replace the “instruction” text with your explanations/interpretations</li>
</ul></li>
<li>If you received a zero, you should have an email from me</li>
</ul></li>
<li>Lab02 released</li>
<li>HW01 released - let’s take a look</li>
</ul>
</section>
<section id="agenda" class="level2">
<h2 class="anchored" data-anchor-id="agenda">Agenda</h2>
<ul>
<li><code>dplyr</code>
<ul>
<li>philosophy</li>
<li>pipes</li>
<li>common operations</li>
</ul></li>
</ul>
</section>
<section id="philosophy" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="philosophy">Philosophy</h2>
<blockquote class="blockquote">
<p><code>dplyr</code> is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges</p>
</blockquote>

<div class="no-row-height column-margin column-container"><div class="">
<p>Source: <a href="https://dplyr.tidyverse.org/">dplyr.tidyverse.org</a></p>
</div></div></section>
</section>
<section id="pipes" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Pipes</h1>
<section id="the-pipe-in-baser" class="level2">
<h2 class="anchored" data-anchor-id="the-pipe-in-baser">The pipe in baseR</h2>
<p align="center">
</p><p><img src="images/02/baseR_hex.jpeg" width="300" height="300" align="center"></p>
<p></p>
<ul>
<li><code>|&gt;</code> should be read as “and then”</li>
<li>for example “Wake up |&gt; brush teeth” would be read as “wake up <em>and then</em> brush teeth”</li>
</ul>
</section>
<section id="where-does-the-name-come-from" class="level2">
<h2 class="anchored" data-anchor-id="where-does-the-name-come-from">Where does the name come from?</h2>
<p>The pipe operator was <em>first</em> implemented in the package <strong>magrittr</strong>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="images/02/magritte.jpg" class="img-fluid"></p>
</div><div class="column" style="width:50%;">
<p><img src="images/02/magrittr.jpg" class="img-fluid"></p>
</div>
</div>
<p>You will see this frequently in code online. It’s equivalent to <code>|&gt;</code>.</p>
</section>
<section id="review-how-does-a-pipe-work" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="review-how-does-a-pipe-work">Review: How does a pipe work?</h2>
<ul>
<li>You can think about the following sequence of actions - find key, unlock car, start car, drive to school, park.</li>
</ul>
<div class="incremental">
<ul>
<li>Expressed as a set of nested functions in R pseudocode this would look like:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">park</span>(<span class="fu">drive</span>(<span class="fu">start_car</span>(<span class="fu">find</span>(<span class="st">"keys"</span>)), <span class="at">to =</span> <span class="st">"campus"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="incremental">
<ul>
<li>Writing it out using pipes give it a more natural (and easier to read) structure:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span>(<span class="st">"keys"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">start_car</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drive</span>(<span class="at">to =</span> <span class="st">"campus"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">park</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
<section id="data" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Data</h1>
<section id="nc-dot-fatal-crashes-in-north-carolina" class="level2">
<h2 class="anchored" data-anchor-id="nc-dot-fatal-crashes-in-north-carolina">NC DOT Fatal Crashes in North Carolina</h2>
<p>From OpenDurham’s Data Portal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bike <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"https://raw.githubusercontent.com/COGS137/datasets/main/nc_bike_crash.csv"</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na =</span> <span class="fu">c</span>(<span class="st">"NA"</span>, <span class="st">""</span>, <span class="st">"."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variables" class="level2">
<h2 class="anchored" data-anchor-id="variables">Variables</h2>
<p>View the names of variables via</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(bike)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FID"        "OBJECTID"   "AmbulanceR" "BikeAge_Gr" "Bike_Age"  
 [6] "Bike_Alc_D" "Bike_Dir"   "Bike_Injur" "Bike_Pos"   "Bike_Race" 
[11] "Bike_Sex"   "City"       "County"     "CrashAlcoh" "CrashDay"  
[16] "Crash_Date" "Crash_Grp"  "Crash_Hour" "Crash_Loc"  "Crash_Mont"
[21] "Crash_Time" "Crash_Type" "Crash_Ty_1" "Crash_Year" "Crsh_Sevri"
[26] "Developmen" "DrvrAge_Gr" "Drvr_Age"   "Drvr_Alc_D" "Drvr_EstSp"
[31] "Drvr_Injur" "Drvr_Race"  "Drvr_Sex"   "Drvr_VehTy" "ExcsSpdInd"
[36] "Hit_Run"    "Light_Cond" "Locality"   "Num_Lanes"  "Num_Units" 
[41] "Rd_Charact" "Rd_Class"   "Rd_Conditi" "Rd_Config"  "Rd_Defects"
[46] "Rd_Feature" "Rd_Surface" "Region"     "Rural_Urba" "Speed_Limi"
[51] "Traff_Cntr" "Weather"    "Workzone_I" "Location"  </code></pre>
</div>
</div>
</section>
<section id="viewing-your-data" class="level2">
<h2 class="anchored" data-anchor-id="viewing-your-data">Viewing your data</h2>
<ul>
<li><p>In the Environment, click on the name of the data frame to view it in the data viewer (or use the <code>View</code> function)</p></li>
<li><p>Use the <code>glimpse</code> function to take a peek</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(bike)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,716
Columns: 54
$ FID        &lt;dbl&gt; 18, 29, 33, 35, 49, 53, 56, 60, 63, 66, 72, 75, 82, 84, 85,…
$ OBJECTID   &lt;dbl&gt; 19, 30, 34, 36, 50, 54, 57, 61, 64, 67, 73, 76, 83, 85, 86,…
$ AmbulanceR &lt;chr&gt; "No", "Yes", "No", "Yes", "No", "Yes", "Yes", "No", "Yes", …
$ BikeAge_Gr &lt;chr&gt; NA, "50-59", NA, "16-19", NA, "50-59", "16-19", "40-49", "1…
$ Bike_Age   &lt;dbl&gt; 6, 51, 10, 17, 6, 52, 18, 40, 6, 7, 45, 30, 17, 20, 14, 15,…
$ Bike_Alc_D &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No", "No", "No",…
$ Bike_Dir   &lt;chr&gt; "Not Applicable", "With Traffic", "With Traffic", NA, "Faci…
$ Bike_Injur &lt;chr&gt; "C: Possible Injury", "C: Possible Injury", "Injury", "B: E…
$ Bike_Pos   &lt;chr&gt; "Driveway / Alley", "Travel Lane", "Travel Lane", "Travel L…
$ Bike_Race  &lt;chr&gt; "Black", "Black", "Black", "White", "Black", "White", "Blac…
$ Bike_Sex   &lt;chr&gt; "Female", "Male", "Male", "Male", "Male", "Male", "Female",…
$ City       &lt;chr&gt; "Durham", "Greenville", "Farmville", "Charlotte", "Charlott…
$ County     &lt;chr&gt; "Durham", "Pitt", "Pitt", "Mecklenburg", "Mecklenburg", "Du…
$ CrashAlcoh &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No", "No", "No",…
$ CrashDay   &lt;chr&gt; "01-01-06", "01-01-02", "01-01-07", "01-01-05", NA, NA, NA,…
$ Crash_Date &lt;date&gt; 2007-01-06, 2007-01-09, 2007-01-14, 2007-01-12, 2007-01-15…
$ Crash_Grp  &lt;chr&gt; "Bicyclist Failed to Yield - Midblock", "Crossing Paths - O…
$ Crash_Hour &lt;dbl&gt; 13, 23, 16, 19, 12, 20, 19, 14, 16, 0, 17, 18, 14, 17, 19, …
$ Crash_Loc  &lt;chr&gt; "Non-Intersection", "Intersection-Related", "Intersection",…
$ Crash_Mont &lt;chr&gt; NA, NA, NA, NA, NA, "01-04-01", "01-04-01", NA, "01-02-01",…
$ Crash_Time &lt;dttm&gt; 0001-01-01 13:17:58, 0001-01-01 23:08:58, 0001-01-01 16:44…
$ Crash_Type &lt;chr&gt; "Bicyclist Ride Out - Residential Driveway", "Crossing Path…
$ Crash_Ty_1 &lt;dbl&gt; 353311, 211180, 111144, 119139, 112114, 311231, 119144, 132…
$ Crash_Year &lt;dbl&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007,…
$ Crsh_Sevri &lt;chr&gt; "C: Possible Injury", "C: Possible Injury", "O: No Injury",…
$ Developmen &lt;chr&gt; "Residential", "Commercial", "Residential", "Residential", …
$ DrvrAge_Gr &lt;chr&gt; "60-69", "30-39", "50-59", "30-39", NA, "20-24", "40-49", N…
$ Drvr_Age   &lt;dbl&gt; 66, 34, 52, 33, NA, 20, 40, NA, 17, 51, NA, 64, 50, 66, 30,…
$ Drvr_Alc_D &lt;chr&gt; "No", "No", "No", "No", "Missing", "No", "No", "Missing", "…
$ Drvr_EstSp &lt;chr&gt; "11-15 mph", "0-5 mph", "21-25 mph", "46-50 mph", "16-20 mp…
$ Drvr_Injur &lt;chr&gt; "O: No Injury", "O: No Injury", "O: No Injury", "O: No Inju…
$ Drvr_Race  &lt;chr&gt; "Black", "Black", "White", "White", "/Missing", "White", "B…
$ Drvr_Sex   &lt;chr&gt; "Male", "Male", "Female", "Female", NA, "Female", "Male", N…
$ Drvr_VehTy &lt;chr&gt; "Pickup", "Passenger Car", "Passenger Car", "Sport Utility"…
$ ExcsSpdInd &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No", "No", "No",…
$ Hit_Run    &lt;chr&gt; "No", "No", "No", "No", "Yes", "No", "No", "Yes", "No", "No…
$ Light_Cond &lt;chr&gt; "Daylight", "Dark - Lighted Roadway", "Daylight", "Dark - R…
$ Locality   &lt;chr&gt; "Mixed (30% To 70% Developed)", "Urban (&gt;70% Developed)", "…
$ Num_Lanes  &lt;chr&gt; "2 lanes", "5 lanes", "2 lanes", "4 lanes", "2 lanes", "4 l…
$ Num_Units  &lt;dbl&gt; 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
$ Rd_Charact &lt;chr&gt; "Straight - Level", "Straight - Level", "Straight - Level",…
$ Rd_Class   &lt;chr&gt; "Local Street", "Local Street", "Local Street", "NC Route",…
$ Rd_Conditi &lt;chr&gt; "Dry", "Dry", "Dry", "Dry", "Dry", "Dry", "Dry", "Dry", "Dr…
$ Rd_Config  &lt;chr&gt; "Two-Way, Not Divided", "Two-Way, Divided, Unprotected Medi…
$ Rd_Defects &lt;chr&gt; "None", "None", "None", "None", "None", "None", "None", "No…
$ Rd_Feature &lt;chr&gt; "No Special Feature", "Four-Way Intersection", "Four-Way In…
$ Rd_Surface &lt;chr&gt; "Smooth Asphalt", "Smooth Asphalt", "Smooth Asphalt", "Smoo…
$ Region     &lt;chr&gt; "Piedmont", "Coastal", "Coastal", "Piedmont", "Piedmont", "…
$ Rural_Urba &lt;chr&gt; "Urban", "Urban", "Rural", "Urban", "Urban", "Urban", "Urba…
$ Speed_Limi &lt;chr&gt; "20 - 25  MPH", "40 - 45  MPH", "30 - 35  MPH", "40 - 45  M…
$ Traff_Cntr &lt;chr&gt; "No Control Present", "Stop And Go Signal", "Stop Sign", "S…
$ Weather    &lt;chr&gt; "Clear", "Clear", "Clear", "Cloudy", "Clear", "Clear", "Cle…
$ Workzone_I &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No", "No", "No",…
$ Location   &lt;chr&gt; "36.002743, -78.8785", "35.612984, -77.39265", "35.595676, …</code></pre>
</div>
</div>
</section>
</section>
<section id="dplyr" class="level1 page-columns page-full" data-background-color="#92A86A">
<h1 data-background-color="#92A86A"><code>dplyr</code></h1>
<section id="a-grammar-of-data-manipulation" class="level2 smaller scrollable">
<h2 class="smaller scrollable anchored" data-anchor-id="a-grammar-of-data-manipulation">A Grammar of Data Manipulation</h2>
<p><strong>dplyr</strong> is based on the concepts of functions as verbs that manipulate data frames.</p>
<p>Single data frame functions / verbs:</p>
<ul>
<li><code>filter</code>: pick rows matching criteria</li>
<li><code>slice</code>: pick rows using index(es)</li>
<li><code>select</code>: pick columns by name</li>
<li><code>pull</code>: grab a column as a vector</li>
<li><code>rename</code>: rename specific columns</li>
<li><code>arrange</code>: reorder rows</li>
<li><code>mutate</code>: add new variables</li>
<li><code>transmute</code>: create new data frame with variables</li>
<li><code>distinct</code>: filter for unique rows</li>
<li><code>sample_n</code> / <code>sample_frac</code>: randomly sample rows</li>
<li><code>summarize</code>: reduce variables to values</li>
<li>… (many more)</li>
</ul>
</section>
<section id="dplyr-rules-for-functions" class="level2">
<h2 class="anchored" data-anchor-id="dplyr-rules-for-functions"><strong><code>dplyr</code></strong> rules for functions</h2>
<ol type="1">
<li><p>First argument is <em>always</em> a data frame</p></li>
<li><p>Subsequent arguments say what to do with that data frame</p></li>
<li><p>Always return a data frame</p></li>
<li><p>Do not modify in place</p></li>
<li><p>Performance via lazy evaluation</p></li>
</ol>
</section>
<section id="filter-rows-with-filter" class="level2">
<h2 class="anchored" data-anchor-id="filter-rows-with-filter">Filter rows with <code>filter</code></h2>
<ul>
<li>Select a subset of rows in a data frame.</li>
<li>Easily filter for many conditions at once.</li>
</ul>
</section>
<section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter"><code>filter</code></h2>
<p>for crashes in Durham County</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">filter</span>(County <span class="sc">==</span> <span class="st">"Durham"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 253 × 54
     FID OBJEC…¹ Ambul…² BikeA…³ Bike_…⁴ Bike_…⁵ Bike_…⁶ Bike_…⁷ Bike_…⁸ Bike_…⁹
   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1    18      19 No      &lt;NA&gt;          6 No      Not Ap… C: Pos… Drivew… Black  
 2    53      54 Yes     50-59        52 No      With T… A: Dis… Travel… White  
 3    56      57 Yes     16-19        18 No      &lt;NA&gt;    C: Pos… Travel… Black  
 4   209     210 No      16-19        16 No      Facing… C: Pos… &lt;NA&gt;    Black  
 5   228     229 Yes     40-49        40 No      With T… B: Evi… Bike L… Black  
 6   620     621 Yes     50-59        55 No      With T… B: Evi… Travel… White  
 7   667     668 Yes     60-69        61 No      Not Ap… B: Evi… Sidewa… Black  
 8   458     459 Yes     60-69        62 No      With T… B: Evi… Travel… White  
 9   576     577 No      40-49        49 No      With T… C: Pos… Travel… Black  
10   618     619 No      20-24        23 No      With T… C: Pos… Travel… Asian  
# … with 243 more rows, 44 more variables: Bike_Sex &lt;chr&gt;, City &lt;chr&gt;,
#   County &lt;chr&gt;, CrashAlcoh &lt;chr&gt;, CrashDay &lt;chr&gt;, Crash_Date &lt;date&gt;,
#   Crash_Grp &lt;chr&gt;, Crash_Hour &lt;dbl&gt;, Crash_Loc &lt;chr&gt;, Crash_Mont &lt;chr&gt;,
#   Crash_Time &lt;dttm&gt;, Crash_Type &lt;chr&gt;, Crash_Ty_1 &lt;dbl&gt;, Crash_Year &lt;dbl&gt;,
#   Crsh_Sevri &lt;chr&gt;, Developmen &lt;chr&gt;, DrvrAge_Gr &lt;chr&gt;, Drvr_Age &lt;dbl&gt;,
#   Drvr_Alc_D &lt;chr&gt;, Drvr_EstSp &lt;chr&gt;, Drvr_Injur &lt;chr&gt;, Drvr_Race &lt;chr&gt;,
#   Drvr_Sex &lt;chr&gt;, Drvr_VehTy &lt;chr&gt;, ExcsSpdInd &lt;chr&gt;, Hit_Run &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="filter-1" class="level2">
<h2 class="anchored" data-anchor-id="filter-1"><code>filter</code></h2>
<p>for crashes in Durham County where biker was &lt; 10 yrs old</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">filter</span>(County <span class="sc">==</span> <span class="st">"Durham"</span>, Bike_Age <span class="sc">&lt;</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 54
     FID OBJEC…¹ Ambul…² BikeA…³ Bike_…⁴ Bike_…⁵ Bike_…⁶ Bike_…⁷ Bike_…⁸ Bike_…⁹
   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1    18      19 No      &lt;NA&gt;          6 No      Not Ap… C: Pos… Drivew… Black  
 2    47      48 No      10-Jun        9 No      Not Ap… O: No … Non-Ro… Black  
 3   124     125 Yes     10-Jun        8 No      With T… C: Pos… Travel… Black  
 4   531     532 Yes     10-Jun        7 No      With T… C: Pos… Travel… Black  
 5   704     705 Yes     10-Jun        9 No      Not Ap… C: Pos… Non-Ro… Black  
 6    42      43 No      10-Jun        8 No      With T… O: No … Travel… Black  
 7   392     393 Yes     0-5           2 No      Not Ap… B: Evi… Drivew… Black  
 8   941     942 No      10-Jun        9 No      With T… C: Pos… Travel… Black  
 9   436     437 Yes     10-Jun        6 No      Not Ap… O: No … Drivew… Black  
10   160     161 Yes     10-Jun        7 No      With T… C: Pos… Travel… Black  
11   273     274 Yes     10-Jun        7 No      Facing… C: Pos… Travel… Black  
12    78      79 Yes     10-Jun        7 No      With T… C: Pos… Travel… Black  
13   422     423 No      10-Jun        9 No      Not Ap… O: No … Drivew… Black  
14   570     571 No      &lt;NA&gt;          0 Missing Not Ap… Injury  Non-Ro… /Missi…
15   683     684 Yes     10-Jun        8 No      Not Ap… C: Pos… Non-Ro… Black  
16    62      63 Yes     10-Jun        7 No      With T… C: Pos… Travel… Black  
17   248     249 No      0-5           4 No      Not Ap… O: No … Drivew… Hispan…
18   306     307 Yes     10-Jun        8 No      With T… C: Pos… &lt;NA&gt;    Black  
19   231     232 Yes     10-Jun        8 No      With T… C: Pos… Travel… Black  
20   361     362 Yes     10-Jun        9 No      With T… B: Evi… Travel… Hispan…
# … with 44 more variables: Bike_Sex &lt;chr&gt;, City &lt;chr&gt;, County &lt;chr&gt;,
#   CrashAlcoh &lt;chr&gt;, CrashDay &lt;chr&gt;, Crash_Date &lt;date&gt;, Crash_Grp &lt;chr&gt;,
#   Crash_Hour &lt;dbl&gt;, Crash_Loc &lt;chr&gt;, Crash_Mont &lt;chr&gt;, Crash_Time &lt;dttm&gt;,
#   Crash_Type &lt;chr&gt;, Crash_Ty_1 &lt;dbl&gt;, Crash_Year &lt;dbl&gt;, Crsh_Sevri &lt;chr&gt;,
#   Developmen &lt;chr&gt;, DrvrAge_Gr &lt;chr&gt;, Drvr_Age &lt;dbl&gt;, Drvr_Alc_D &lt;chr&gt;,
#   Drvr_EstSp &lt;chr&gt;, Drvr_Injur &lt;chr&gt;, Drvr_Race &lt;chr&gt;, Drvr_Sex &lt;chr&gt;,
#   Drvr_VehTy &lt;chr&gt;, ExcsSpdInd &lt;chr&gt;, Hit_Run &lt;chr&gt;, Light_Cond &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="aside-real-data-is-messy" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="aside-real-data-is-messy">Aside: real data is messy!</h2>
<p><span style="background-color: #ADD8E6"><i class="fa fa-user" aria-hidden="true"></i> &nbsp; What in the world does a <code>BikeAge_gr</code> of <code>10-Jun</code> or <code>15-Nov</code> mean?</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(BikeAge_Gr) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">crash_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   BikeAge_Gr crash_count
   &lt;chr&gt;            &lt;int&gt;
 1 0-5                 60
 2 10-Jun             421
 3 15-Nov             747
 4 16-19              605
 5 20-24              680
 6 25-29              430
 7 30-39              658
 8 40-49              920
 9 50-59              739
10 60-69              274
11 70                  12
12 70+                 58
13 &lt;NA&gt;               112</code></pre>
</div>
</div>
</section>
<section id="careful-data-scientists-clean-up-their-data-first" class="level2">
<h2 class="anchored" data-anchor-id="careful-data-scientists-clean-up-their-data-first">Careful data scientists clean up their data first!</h2>
<ul>
<li>We’re going to need to do some text parsing to clean up these data
<ul>
<li><code>10-Jun</code> should be <code>6-10</code></li>
<li><code>15-Nov</code> should be <code>11-15</code></li>
</ul></li>
</ul>
</section>
<section id="correct-and-overwrite-mutate" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="correct-and-overwrite-mutate">Correct and overwrite <code>mutate</code></h2>
<ul>
<li>Remember we want to do the following in the <code>BikeAge_Gr</code> variable
<ul>
<li><code>10-Jun</code> should be <code>6-10</code></li>
<li><code>15-Nov</code> should be <code>11-15</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>bike <span class="ot">&lt;-</span> bike <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="at">BikeAge_Gr =</span> <span class="fu">case_when</span>(</span>
<span id="cb14-4"><a href="#cb14-4"></a>      BikeAge_Gr <span class="sc">==</span> <span class="st">"10-Jun"</span> <span class="sc">~</span> <span class="st">"6-10"</span>,</span>
<span id="cb14-5"><a href="#cb14-5"></a>      BikeAge_Gr <span class="sc">==</span> <span class="st">"15-Nov"</span> <span class="sc">~</span> <span class="st">"11-15"</span>,</span>
<span id="cb14-6"><a href="#cb14-6"></a>      <span class="cn">TRUE</span>                   <span class="sc">~</span> BikeAge_Gr     <span class="co"># everything else</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>    )</span>
<span id="cb14-8"><a href="#cb14-8"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Note that we’re overwriting existing data and columns, so be careful!
<ul>
<li>But remember, it’s easy to revert if you make a mistake since we didn’t touch the raw data, we can always reload it and start over</li>
</ul></li>
</ul>
</section>
<section id="check-before-you-move-on" class="level2">
<h2 class="anchored" data-anchor-id="check-before-you-move-on">Check before you move on</h2>
<p>Always check your changes and confirm code did what you wanted it to do</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(BikeAge_Gr) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   BikeAge_Gr count
   &lt;chr&gt;      &lt;int&gt;
 1 0-5           60
 2 11-15        747
 3 16-19        605
 4 20-24        680
 5 25-29        430
 6 30-39        658
 7 40-49        920
 8 50-59        739
 9 6-10         421
10 60-69        274
11 70            12
12 70+           58
13 &lt;NA&gt;         112</code></pre>
</div>
</div>
</section>
<section id="mutate-to-add-new-variables" class="level2">
<h2 class="anchored" data-anchor-id="mutate-to-add-new-variables"><code>mutate</code> to add new variables</h2>
<p><span style="background-color: #ADD8E6"><i class="fa fa-user" aria-hidden="true"></i> &nbsp; How is the new <code>alcohol</code> variable determined?</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alcohol =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    Bike_Alc_D <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;</span> Drvr_Alc_D <span class="sc">==</span> <span class="st">"No"</span>      <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    Bike_Alc_D <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">|</span> Drvr_Alc_D <span class="sc">==</span> <span class="st">"Yes"</span>    <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    Bike_Alc_D <span class="sc">==</span> <span class="st">"Missing"</span> <span class="sc">&amp;</span> Drvr_Alc_D <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="st">"Missing"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    Bike_Alc_D <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;</span> Drvr_Alc_D <span class="sc">==</span> <span class="st">"Missing"</span> <span class="sc">~</span> <span class="st">"Missing"</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="save-when-you-mutate" class="level2">
<h2 class="anchored" data-anchor-id="save-when-you-mutate">“Save” when you <code>mutate</code></h2>
<p>Most often when you define a new variable with <code>mutate</code> you’ll also want to save the resulting data frame, often by writing over the original data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bike <span class="ot">&lt;-</span> bike <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alcohol =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    Bike_Alc_D <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;</span> Drvr_Alc_D <span class="sc">==</span> <span class="st">"No"</span>      <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    Bike_Alc_D <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">|</span> Drvr_Alc_D <span class="sc">==</span> <span class="st">"Yes"</span>    <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    Bike_Alc_D <span class="sc">==</span> <span class="st">"Missing"</span> <span class="sc">&amp;</span> Drvr_Alc_D <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">~</span> <span class="st">"Missing"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    Bike_Alc_D <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;</span> Drvr_Alc_D <span class="sc">==</span> <span class="st">"Missing"</span> <span class="sc">~</span> <span class="st">"Missing"</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="transmute-to-create-a-new-dataset" class="level2">
<h2 class="anchored" data-anchor-id="transmute-to-create-a-new-dataset"><code>transmute</code> to create a new dataset</h2>
<p>You’ll use this much less often than <code>mutate</code> but when you need it, you need it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>bike <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">transmute</span>(<span class="at">ID =</span> <span class="fu">paste</span>(FID, OBJECTID, <span class="at">sep =</span> <span class="st">"-"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,716 × 1
   ID   
   &lt;chr&gt;
 1 18-19
 2 29-30
 3 33-34
 4 35-36
 5 49-50
 6 53-54
 7 56-57
 8 60-61
 9 63-64
10 66-67
# … with 5,706 more rows</code></pre>
</div>
</div>
</section>
<section id="mutate-vs.-transmute" class="level2">
<h2 class="anchored" data-anchor-id="mutate-vs.-transmute"><code>mutate</code> vs.&nbsp;<code>transmute</code></h2>
<ul>
<li><code>mutate</code> adds new and keeps original</li>
<li><code>transmute</code> adds new; drops existing</li>
</ul>
</section>
<section id="your-turn" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="your-turn">Your Turn</h2>
<p>How many accidents in our dataset required an ambulance ride (<code>AmbulanceR</code>) <em>and</em> had the <code>Crash_Type</code> “Bicyclist Lost Control - Mechanical Problems”?</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Put a <font color="#32cb31">green</font> sticky on the front of your computer when you’re done. Put a <font color="#ff65a3">pink</font> if you want help/have a question.</p>
</div></div></section>
<section id="slice-for-certain-row-numbers" class="level2">
<h2 class="anchored" data-anchor-id="slice-for-certain-row-numbers"><code>slice</code> for certain row numbers</h2>
<p>First five</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 54
    FID OBJECTID Ambul…¹ BikeA…² Bike_…³ Bike_…⁴ Bike_…⁵ Bike_…⁶ Bike_…⁷ Bike_…⁸
  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1    18       19 No      &lt;NA&gt;          6 No      Not Ap… C: Pos… Drivew… Black  
2    29       30 Yes     50-59        51 No      With T… C: Pos… Travel… Black  
3    33       34 No      &lt;NA&gt;         10 No      With T… Injury  Travel… Black  
4    35       36 Yes     16-19        17 No      &lt;NA&gt;    B: Evi… Travel… White  
5    49       50 No      &lt;NA&gt;          6 No      Facing… O: No … Travel… Black  
# … with 44 more variables: Bike_Sex &lt;chr&gt;, City &lt;chr&gt;, County &lt;chr&gt;,
#   CrashAlcoh &lt;chr&gt;, CrashDay &lt;chr&gt;, Crash_Date &lt;date&gt;, Crash_Grp &lt;chr&gt;,
#   Crash_Hour &lt;dbl&gt;, Crash_Loc &lt;chr&gt;, Crash_Mont &lt;chr&gt;, Crash_Time &lt;dttm&gt;,
#   Crash_Type &lt;chr&gt;, Crash_Ty_1 &lt;dbl&gt;, Crash_Year &lt;dbl&gt;, Crsh_Sevri &lt;chr&gt;,
#   Developmen &lt;chr&gt;, DrvrAge_Gr &lt;chr&gt;, Drvr_Age &lt;dbl&gt;, Drvr_Alc_D &lt;chr&gt;,
#   Drvr_EstSp &lt;chr&gt;, Drvr_Injur &lt;chr&gt;, Drvr_Race &lt;chr&gt;, Drvr_Sex &lt;chr&gt;,
#   Drvr_VehTy &lt;chr&gt;, ExcsSpdInd &lt;chr&gt;, Hit_Run &lt;chr&gt;, Light_Cond &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="slice-for-certain-row-numbers-1" class="level2">
<h2 class="anchored" data-anchor-id="slice-for-certain-row-numbers-1"><code>slice</code> for certain row numbers</h2>
<p>Last five</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>last_row <span class="ot">&lt;-</span> <span class="fu">nrow</span>(bike)</span>
<span id="cb23-2"><a href="#cb23-2"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">slice</span>((last_row <span class="sc">-</span> <span class="dv">4</span>)<span class="sc">:</span>last_row)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 54
    FID OBJECTID Ambul…¹ BikeA…² Bike_…³ Bike_…⁴ Bike_…⁵ Bike_…⁶ Bike_…⁷ Bike_…⁸
  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1   460      461 Yes     6-10          7 No      Not Ap… C: Pos… Drivew… Black  
2   474      475 Yes     50-59        50 No      With T… B: Evi… Travel… White  
3   479      480 Yes     16-19        16 No      Not Ap… C: Pos… Sidewa… White  
4   487      488 No      40-49        47 Yes     With T… C: Pos… Travel… White  
5   488      489 Yes     30-39        35 No      Facing… C: Pos… Travel… Black  
# … with 44 more variables: Bike_Sex &lt;chr&gt;, City &lt;chr&gt;, County &lt;chr&gt;,
#   CrashAlcoh &lt;chr&gt;, CrashDay &lt;chr&gt;, Crash_Date &lt;date&gt;, Crash_Grp &lt;chr&gt;,
#   Crash_Hour &lt;dbl&gt;, Crash_Loc &lt;chr&gt;, Crash_Mont &lt;chr&gt;, Crash_Time &lt;dttm&gt;,
#   Crash_Type &lt;chr&gt;, Crash_Ty_1 &lt;dbl&gt;, Crash_Year &lt;dbl&gt;, Crsh_Sevri &lt;chr&gt;,
#   Developmen &lt;chr&gt;, DrvrAge_Gr &lt;chr&gt;, Drvr_Age &lt;dbl&gt;, Drvr_Alc_D &lt;chr&gt;,
#   Drvr_EstSp &lt;chr&gt;, Drvr_Injur &lt;chr&gt;, Drvr_Race &lt;chr&gt;, Drvr_Sex &lt;chr&gt;,
#   Drvr_VehTy &lt;chr&gt;, ExcsSpdInd &lt;chr&gt;, Hit_Run &lt;chr&gt;, Light_Cond &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="select-to-keep-only-the-variables-you-mention" class="level2">
<h2 class="anchored" data-anchor-id="select-to-keep-only-the-variables-you-mention"><code>select</code> to keep only the variables you mention</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">select</span>(Crash_Loc, Hit_Run) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      Hit_Run
Crash_Loc                No  Yes
  Intersection         2223  275
  Intersection-Related  252   42
  Location                3    7
  Non-Intersection     2213  462
  Non-Roadway           205   30</code></pre>
</div>
</div>
</section>
<section id="or-select-to-exclude-variables" class="level2">
<h2 class="anchored" data-anchor-id="or-select-to-exclude-variables">or <code>select</code> to exclude variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>OBJECTID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,716 × 53
     FID Ambul…¹ BikeA…² Bike_…³ Bike_…⁴ Bike_…⁵ Bike_…⁶ Bike_…⁷ Bike_…⁸ Bike_…⁹
   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1    18 No      &lt;NA&gt;          6 No      Not Ap… C: Pos… Drivew… Black   Female 
 2    29 Yes     50-59        51 No      With T… C: Pos… Travel… Black   Male   
 3    33 No      &lt;NA&gt;         10 No      With T… Injury  Travel… Black   Male   
 4    35 Yes     16-19        17 No      &lt;NA&gt;    B: Evi… Travel… White   Male   
 5    49 No      &lt;NA&gt;          6 No      Facing… O: No … Travel… Black   Male   
 6    53 Yes     50-59        52 No      With T… A: Dis… Travel… White   Male   
 7    56 Yes     16-19        18 No      &lt;NA&gt;    C: Pos… Travel… Black   Female 
 8    60 No      40-49        40 No      Facing… B: Evi… Sidewa… Hispan… Male   
 9    63 Yes     6-10          6 No      Facing… B: Evi… Travel… White   Male   
10    66 Yes     6-10          7 No      &lt;NA&gt;    B: Evi… Non-Ro… Black   Female 
# … with 5,706 more rows, 43 more variables: City &lt;chr&gt;, County &lt;chr&gt;,
#   CrashAlcoh &lt;chr&gt;, CrashDay &lt;chr&gt;, Crash_Date &lt;date&gt;, Crash_Grp &lt;chr&gt;,
#   Crash_Hour &lt;dbl&gt;, Crash_Loc &lt;chr&gt;, Crash_Mont &lt;chr&gt;, Crash_Time &lt;dttm&gt;,
#   Crash_Type &lt;chr&gt;, Crash_Ty_1 &lt;dbl&gt;, Crash_Year &lt;dbl&gt;, Crsh_Sevri &lt;chr&gt;,
#   Developmen &lt;chr&gt;, DrvrAge_Gr &lt;chr&gt;, Drvr_Age &lt;dbl&gt;, Drvr_Alc_D &lt;chr&gt;,
#   Drvr_EstSp &lt;chr&gt;, Drvr_Injur &lt;chr&gt;, Drvr_Race &lt;chr&gt;, Drvr_Sex &lt;chr&gt;,
#   Drvr_VehTy &lt;chr&gt;, ExcsSpdInd &lt;chr&gt;, Hit_Run &lt;chr&gt;, Light_Cond &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="or-select-a-range-of-variables" class="level2">
<h2 class="anchored" data-anchor-id="or-select-a-range-of-variables">or <code>select</code> a range of variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">select</span>(OBJECTID<span class="sc">:</span>Bike_Injur)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,716 × 7
   OBJECTID AmbulanceR BikeAge_Gr Bike_Age Bike_Alc_D Bike_Dir       Bike_Injur 
      &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;          &lt;chr&gt;      
 1       19 No         &lt;NA&gt;              6 No         Not Applicable C: Possibl…
 2       30 Yes        50-59            51 No         With Traffic   C: Possibl…
 3       34 No         &lt;NA&gt;             10 No         With Traffic   Injury     
 4       36 Yes        16-19            17 No         &lt;NA&gt;           B: Evident…
 5       50 No         &lt;NA&gt;              6 No         Facing Traffic O: No Inju…
 6       54 Yes        50-59            52 No         With Traffic   A: Disabli…
 7       57 Yes        16-19            18 No         &lt;NA&gt;           C: Possibl…
 8       61 No         40-49            40 No         Facing Traffic B: Evident…
 9       64 Yes        6-10              6 No         Facing Traffic B: Evident…
10       67 Yes        6-10              7 No         &lt;NA&gt;           B: Evident…
# … with 5,706 more rows</code></pre>
</div>
</div>
</section>
<section id="pull-to-extract-a-column-as-a-vector" class="level2">
<h2 class="anchored" data-anchor-id="pull-to-extract-a-column-as-a-vector"><code>pull</code> to extract a column as a vector</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">pull</span>(Location)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "36.002743, -78.8785"  "35.612984, -77.39265" "35.595676, -77.59074"
[4] "35.076767, -80.7728"  "35.19999, -80.75713"  "35.966644, -78.96749"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Location)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 1
  Location            
  &lt;chr&gt;               
1 36.002743, -78.8785 
2 35.612984, -77.39265
3 35.595676, -77.59074
4 35.076767, -80.7728 
5 35.19999, -80.75713 
6 35.966644, -78.96749</code></pre>
</div>
</div>
</section>
<section id="the-two-pulls-in-your-lives" class="level2 smaller scrollable">
<h2 class="smaller scrollable anchored" data-anchor-id="the-two-pulls-in-your-lives">The two <code>pull</code>s in your lives</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="images/02/hex-dplyr.png" class="img-fluid"></p>
</div><div class="column" style="width:50%;">
<p><img src="images/02/Octocat.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li><p>Don’t get <code>pull</code> happy when wrangling data! Only extract out variables if you truly need to, otherwise keep in data frame.</p></li>
<li><p>But always ⬇️ <code>Pull</code> before starting your work when collaborating on GitHub.</p></li>
</ul>
</section>
<section id="rename-specific-columns" class="level2">
<h2 class="anchored" data-anchor-id="rename-specific-columns"><code>rename</code> specific columns</h2>
<p>Useful for correcting typos, and renaming to make variable names shorter and/or more informative</p>
<ul>
<li>Original names:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(bike)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FID"        "OBJECTID"   "AmbulanceR" "BikeAge_Gr" "Bike_Age"  
 [6] "Bike_Alc_D" "Bike_Dir"   "Bike_Injur" "Bike_Pos"   "Bike_Race" 
[11] "Bike_Sex"   "City"       "County"     "CrashAlcoh" "CrashDay"  
[16] "Crash_Date" "Crash_Grp"  "Crash_Hour" "Crash_Loc"  "Crash_Mont"
[21] "Crash_Time" "Crash_Type" "Crash_Ty_1" "Crash_Year" "Crsh_Sevri"
[26] "Developmen" "DrvrAge_Gr" "Drvr_Age"   "Drvr_Alc_D" "Drvr_EstSp"
[31] "Drvr_Injur" "Drvr_Race"  "Drvr_Sex"   "Drvr_VehTy" "ExcsSpdInd"
[36] "Hit_Run"    "Light_Cond" "Locality"   "Num_Lanes"  "Num_Units" 
[41] "Rd_Charact" "Rd_Class"   "Rd_Conditi" "Rd_Config"  "Rd_Defects"
[46] "Rd_Feature" "Rd_Surface" "Region"     "Rural_Urba" "Speed_Limi"
[51] "Traff_Cntr" "Weather"    "Workzone_I" "Location"  </code></pre>
</div>
</div>
</section>
<section id="rename-specific-columns-1" class="level2">
<h2 class="anchored" data-anchor-id="rename-specific-columns-1"><code>rename</code> specific columns</h2>
<ul>
<li>Rename <code>Speed_Limi</code> to <code>Speed_Limit</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>bike <span class="ot">&lt;-</span> bike <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">rename</span>(<span class="at">Speed_Limit =</span> Speed_Limi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-before-you-move-on-1" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="check-before-you-move-on-1">Check before you move on</h2>
<p>Always check your changes and confirm code did what you wanted it to do</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(bike)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "FID"         "OBJECTID"    "AmbulanceR"  "BikeAge_Gr"  "Bike_Age"   
 [6] "Bike_Alc_D"  "Bike_Dir"    "Bike_Injur"  "Bike_Pos"    "Bike_Race"  
[11] "Bike_Sex"    "City"        "County"      "CrashAlcoh"  "CrashDay"   
[16] "Crash_Date"  "Crash_Grp"   "Crash_Hour"  "Crash_Loc"   "Crash_Mont" 
[21] "Crash_Time"  "Crash_Type"  "Crash_Ty_1"  "Crash_Year"  "Crsh_Sevri" 
[26] "Developmen"  "DrvrAge_Gr"  "Drvr_Age"    "Drvr_Alc_D"  "Drvr_EstSp" 
[31] "Drvr_Injur"  "Drvr_Race"   "Drvr_Sex"    "Drvr_VehTy"  "ExcsSpdInd" 
[36] "Hit_Run"     "Light_Cond"  "Locality"    "Num_Lanes"   "Num_Units"  
[41] "Rd_Charact"  "Rd_Class"    "Rd_Conditi"  "Rd_Config"   "Rd_Defects" 
[46] "Rd_Feature"  "Rd_Surface"  "Region"      "Rural_Urba"  "Speed_Limit"
[51] "Traff_Cntr"  "Weather"     "Workzone_I"  "Location"   </code></pre>
</div>
</div>
</section>
<section id="your-turn-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="your-turn-1">Your Turn</h2>
<p>Your boss in Cumberland County gets overwhelmed by data easily, but he wants some data from you. He wants all bike accidents from his County, but he only wants to know the road’s speed limit, the age of the biker, and to know if alcohol was involved. If you have time, mine as well make the column names very clear to your boss while you’re at it…</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Put a <font color="#32cb31">green</font> sticky on the front of your computer when you’re done. Put a <font color="#ff65a3">pink</font> if you want help/have a question.</p>
</div></div></section>
<section id="summarize-to-reduce-variables-to-values" class="level2">
<h2 class="anchored" data-anchor-id="summarize-to-reduce-variables-to-values"><code>summarize</code> to reduce variables to values</h2>
<p>The values are summarized in a data frame</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">group_by</span>(BikeAge_Gr) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">summarize</span>(<span class="at">crash_count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   BikeAge_Gr crash_count
   &lt;chr&gt;            &lt;int&gt;
 1 0-5                 60
 2 11-15              747
 3 16-19              605
 4 20-24              680
 5 25-29              430
 6 30-39              658
 7 40-49              920
 8 50-59              739
 9 6-10               421
10 60-69              274
11 70                  12
12 70+                 58
13 &lt;NA&gt;               112</code></pre>
</div>
</div>
</section>
<section id="and-arrange-to-order-rows" class="level2">
<h2 class="anchored" data-anchor-id="and-arrange-to-order-rows">and <code>arrange</code> to order rows</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">group_by</span>(BikeAge_Gr) <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="fu">summarize</span>(<span class="at">crash_count =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(crash_count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   BikeAge_Gr crash_count
   &lt;chr&gt;            &lt;int&gt;
 1 40-49              920
 2 11-15              747
 3 50-59              739
 4 20-24              680
 5 30-39              658
 6 16-19              605
 7 25-29              430
 8 6-10               421
 9 60-69              274
10 &lt;NA&gt;               112
11 0-5                 60
12 70+                 58
13 70                  12</code></pre>
</div>
</div>
</section>
<section id="count-to-group-by-then-count" class="level2">
<h2 class="anchored" data-anchor-id="count-to-group-by-then-count"><code>count</code> to group by then count</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>bike <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(BikeAge_Gr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   BikeAge_Gr     n
   &lt;chr&gt;      &lt;int&gt;
 1 0-5           60
 2 11-15        747
 3 16-19        605
 4 20-24        680
 5 25-29        430
 6 30-39        658
 7 40-49        920
 8 50-59        739
 9 6-10         421
10 60-69        274
11 70            12
12 70+           58
13 &lt;NA&gt;         112</code></pre>
</div>
</div>
<p><span style="background-color: #ADD8E6"><i class="fa fa-user" aria-hidden="true"></i> &nbsp; If you wanted to arrange these in ascending order what would you add to the pipe?</span></p>
</section>
<section id="select-rows-with-sample_n-or-sample_frac" class="level2">
<h2 class="anchored" data-anchor-id="select-rows-with-sample_n-or-sample_frac">Select rows with <code>sample_n</code> or <code>sample_frac</code></h2>
<ul>
<li><code>sample_n</code>: randomly sample 5 observations</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>bike_n5 <span class="ot">&lt;-</span> bike <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">sample_n</span>(<span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="fu">dim</span>(bike_n5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  5 54</code></pre>
</div>
</div>
<ul>
<li><code>sample_frac</code>: randomly sample 20% of observations</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>bike_perc20 <span class="ot">&lt;-</span> bike <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">sample_frac</span>(<span class="fl">0.2</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="fu">dim</span>(bike_perc20)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1143   54</code></pre>
</div>
</div>
</section>
<section id="distinct-to-filter-for-unique-rows" class="level2">
<h2 class="anchored" data-anchor-id="distinct-to-filter-for-unique-rows"><code>distinct</code> to filter for unique rows</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>bike <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="fu">select</span>(County, City) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="fu">arrange</span>(County, City)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 360 × 2
   County    City              
   &lt;chr&gt;     &lt;chr&gt;             
 1 Alamance  Alamance          
 2 Alamance  Burlington        
 3 Alamance  Elon College      
 4 Alamance  Gibsonville       
 5 Alamance  Graham            
 6 Alamance  Green Level       
 7 Alamance  Mebane            
 8 Alamance  None - Rural Crash
 9 Alexander None - Rural Crash
10 Alleghany None - Rural Crash
# … with 350 more rows</code></pre>
</div>
</div>
</section>
<section id="distinct-has-a-.keep_all-parameter" class="level2">
<h2 class="anchored" data-anchor-id="distinct-has-a-.keep_all-parameter"><code>distinct</code> has a .keep_all parameter</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>bike <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="fu">distinct</span>(County, City, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="fu">arrange</span>(County, City)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 360 × 54
     FID OBJEC…¹ Ambul…² BikeA…³ Bike_…⁴ Bike_…⁵ Bike_…⁶ Bike_…⁷ Bike_…⁸ Bike_…⁹
   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1   524     525 Yes     11-15        12 No      &lt;NA&gt;    B: Evi… &lt;NA&gt;    Black  
 2    84      85 Yes     20-24        20 No      With T… B: Evi… Travel… White  
 3   571     572 Yes     16-19        16 No      Not Ap… B: Evi… Non-Ro… White  
 4   509     510 Yes     40-49        43 Yes     With T… K: Kil… Travel… Black  
 5   855     856 Yes     30-39        30 No      With T… A: Dis… Travel… Black  
 6     5       6 Yes     40-49        44 Yes     With T… C: Pos… Travel… Black  
 7   163     164 Yes     30-39        35 No      Not Ap… C: Pos… &lt;NA&gt;    White  
 8    96      97 Yes     30-39        36 No      With T… C: Pos… Travel… White  
 9    46      47 Yes     50-59        53 No      With T… B: Evi… Travel… White  
10   485     486 Yes     60-69        62 No      With T… C: Pos… Travel… White  
# … with 350 more rows, 44 more variables: Bike_Sex &lt;chr&gt;, City &lt;chr&gt;,
#   County &lt;chr&gt;, CrashAlcoh &lt;chr&gt;, CrashDay &lt;chr&gt;, Crash_Date &lt;date&gt;,
#   Crash_Grp &lt;chr&gt;, Crash_Hour &lt;dbl&gt;, Crash_Loc &lt;chr&gt;, Crash_Mont &lt;chr&gt;,
#   Crash_Time &lt;dttm&gt;, Crash_Type &lt;chr&gt;, Crash_Ty_1 &lt;dbl&gt;, Crash_Year &lt;dbl&gt;,
#   Crsh_Sevri &lt;chr&gt;, Developmen &lt;chr&gt;, DrvrAge_Gr &lt;chr&gt;, Drvr_Age &lt;dbl&gt;,
#   Drvr_Alc_D &lt;chr&gt;, Drvr_EstSp &lt;chr&gt;, Drvr_Injur &lt;chr&gt;, Drvr_Race &lt;chr&gt;,
#   Drvr_Sex &lt;chr&gt;, Drvr_VehTy &lt;chr&gt;, ExcsSpdInd &lt;chr&gt;, Hit_Run &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
</section>
<section id="factors" class="level1 page-columns page-full" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Factors</h1>
<section id="factors-1" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="factors-1">Factors</h2>
<p>Factor objects are how R stores data for categorical variables (fixed numbers of discrete values).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">x =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"BS"</span>, <span class="st">"MS"</span>, <span class="st">"PhD"</span>, <span class="st">"MS"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] BS  MS  PhD MS 
Levels: BS MS PhD</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 3 levels "BS","MS","PhD": 1 2 3 2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
</section>
<section id="returning-to-cat-lovers" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="returning-to-cat-lovers">Returning to: Cat lovers</h2>
<p>Reading in the cat-lovers data…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>cat_lovers <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/COGS137/datasets/main/cat-lovers.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-data-in-as-character-strings" class="level2">
<h2 class="anchored" data-anchor-id="read-data-in-as-character-strings">Read data in as character strings</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(cat_lovers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 60
Columns: 3
$ name           &lt;chr&gt; "Bernice Warren", "Woodrow Stone", "Willie Bass", "Tyro…
$ number_of_cats &lt;chr&gt; "0", "0", "1", "3", "3", "2", "1", "1", "0", "0", "0", …
$ handedness     &lt;chr&gt; "left", "left", "left", "left", "left", "left", "left",…</code></pre>
</div>
</div>
</section>
<section id="but-coerce-when-plotting" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="but-coerce-when-plotting">But coerce when plotting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cat_lovers, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> handedness)) <span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-dplyr_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="use-forcats-to-manipulate-factors" class="level2 scrollable">
<h2 class="scrollable anchored" data-anchor-id="use-forcats-to-manipulate-factors">Use <code>forcats</code> to manipulate factors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>cat_lovers <span class="ot">&lt;-</span> cat_lovers <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">handedness =</span> <span class="fu">fct_relevel</span>(handedness, </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"right"</span>, <span class="st">"left"</span>, <span class="st">"ambidextrous"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cat_lovers, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> handedness)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="02-dplyr_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section>
<section id="forcats-functionality" class="level2 scrollable page-columns page-full">
<h2 class="scrollable anchored" data-anchor-id="forcats-functionality"><code>forcats</code> functionality <img src="images/01/hex-forcats.png" width="10%" align="left"></h2>
<ul>
<li><p>R uses factors to handle categorical variables, variables that have a fixed and known set of possible values. Historically, factors were much easier to work with than character vectors, so many base R functions automatically convert character vectors to factors.</p></li>
<li><p>factors are still useful when you have true categorical data, and when you want to override the ordering of character vectors to improve display. The goal of the forcats package is to provide a suite of useful tools that solve common problems with factors.</p></li>
</ul>

<div class="no-row-height column-margin column-container"><div class="">
<p>Source: <a href="http://forcats.tidyverse.org/">forcats.tidyverse.org</a></p>
</div></div></section>
</section>
<section id="recap" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Recap</h1>
<ul>
<li>Understand the basic tenants of <code>dplyr</code></li>
<li>Describe and utilize the pipe in workflows</li>
<li>Describe and use common <code>verbs</code> (functions)</li>
<li>Understand the documentation for <code>dplyr</code> functions</li>
<li>Understand what factors are an that <code>forcats</code> is a package with functionality for working with them</li>
</ul>
<section id="suggested-reading" class="level2">
<h2 class="anchored" data-anchor-id="suggested-reading">Suggested Reading</h2>
<p>R4DS:</p>
<ul>
<li>Chapter 5: <a href="https://r4ds.had.co.nz/transform.html">Data Transformation</a></li>
<li>Chapter 15: <a href="https://r4ds.had.co.nz/factors.html">Factors</a></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">This page is built with <a href="https://quarto.org/">Quarto</a>.</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../LICENSE.html">License</a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>